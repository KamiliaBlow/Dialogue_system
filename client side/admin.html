<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель администратора - Терминал GMS-4521</title>
    <link href="https://fonts.googleapis.com/css?family=Orbitron:700" rel="stylesheet">
    <link rel="stylesheet" href="styles/admin-styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="background-code" id="bgCode"></div>
    
    <div class="container">
        <header class="admin-header">
            <div class="admin-title">ТЕРМИНАЛ GMS-4521 - ПАНЕЛЬ АДМИНИСТРАТОРА</div>
            <button id="logout-btn" class="admin-logout">ВЫХОД</button>
        </header>
        
        <nav class="admin-tabs">
            <button class="admin-tab active" data-tab="statistics">Статистика</button>
            <button class="admin-tab" data-tab="users">Пользователи</button>
            <button class="admin-tab" data-tab="choices">Выборы</button>
            <button class="admin-tab" data-tab="progress">Прогресс диалогов</button>
            <a href="editor.html" class="admin-tab" style="text-decoration: none;">Редактор диалогов</a>
        </nav>
        
        <main class="admin-content">
            <!-- Statistics Tab -->
            <section id="statistics" class="tab-content active">
                <div class="admin-card">
                    <div class="admin-card-title">Общая статистика</div>
                    <div id="statistics-loading" class="loading">
                        <div class="loading-spinner"></div>
                    </div>
                    <div id="statistics-content">
                        <div class="row">
                            <div class="col">
                                <div class="statistic-card">
                                    <div>
                                        <div class="statistic-value" id="total-users">0</div>
                                        <div class="statistic-label">Всего пользователей</div>
                                    </div>
                                    <div class="statistic-icon">&#128100;</div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="statistic-card">
                                    <div>
                                        <div class="statistic-value" id="total-choices">0</div>
                                        <div class="statistic-label">Всего выборов</div>
                                    </div>
                                    <div class="statistic-icon">&#128260;</div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="statistic-card">
                                    <div>
                                        <div class="statistic-value" id="completed-dialogues">0</div>
                                        <div class="statistic-label">Завершенных диалогов</div>
                                    </div>
                                    <div class="statistic-icon">&#9989;</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="admin-card">
                    <div class="admin-card-title">Распределение выборов по частотам</div>
                    <div class="chart-container">
                        <canvas id="frequency-chart"></canvas>
                    </div>
                </div>
                <div class="admin-card">
                    <div class="admin-card-title">Популярные выборы</div>
                    <div class="chart-container">
                        <canvas id="choices-chart"></canvas>
                    </div>
                </div>
            </section>
            
            <!-- Users Tab -->
            <section id="users" class="tab-content">
                <div class="admin-card">
                    <div class="admin-card-title">Управление пользователями</div>
                    <div class="search-container">
                        <input type="text" id="user-search" class="search-input" placeholder="Поиск пользователя...">
                    </div>
                    <div id="users-loading" class="loading">
                        <div class="loading-spinner"></div>
                    </div>
                    <table class="user-table" id="users-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Позывной</th>
                                <th>Дата регистрации</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body"></tbody>
                    </table>
                    <div class="pagination" id="users-pagination"></div>
                </div>
            </section>
            
            <!-- Choices Tab -->
            <section id="choices" class="tab-content">
                <div class="admin-card">
                    <div class="admin-card-title">Выборы пользователей</div>
                    <div class="sub-tabs"></div>
                    <div id="choices-loading" class="loading">
                        <div class="loading-spinner"></div>
                    </div>
                    <div id="choices-content">
                        <ul class="choice-list" id="choice-list"></ul>
                    </div>
                </div>
            </section>
            
            <!-- Progress Tab -->
            <section id="progress" class="tab-content">
                <div class="admin-card">
                    <div class="admin-card-title">Прогресс пользователей в диалогах</div>
                    <div id="progress-loading" class="loading">
                        <div class="loading-spinner"></div>
                    </div>
                    <div id="progress-content">
                        <div class="chart-container">
                            <canvas id="progress-chart"></canvas>
                        </div>
                        <table class="user-table">
                            <thead>
                                <tr>
                                    <th>Пользователь</th>
                                    <th>Частота</th>
                                    <th>Прогресс</th>
                                    <th>Завершен</th>
                                </tr>
                            </thead>
                            <tbody id="progress-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Password Modal -->
    <div id="password-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title">Изменить пароль</div>
            <div class="modal-body">
                <form id="change-password-form">
                    <input type="hidden" id="user-id-input">
                    <div class="form-group">
                        <label class="form-label">Пользователь:</label>
                        <div id="modal-username"></div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="new-password">Новый пароль:</label>
                        <input type="password" id="new-password" class="form-input" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="confirm-password">Подтвердите пароль:</label>
                        <input type="password" id="confirm-password" class="form-input" required minlength="6">
                    </div>
                    <div id="password-error" class="alert alert-danger" style="display: none;"></div>
                </form>
            </div>
            <div class="modal-actions">
                <button id="cancel-password" class="btn">Отмена</button>
                <button id="save-password" class="btn">Сохранить</button>
            </div>
        </div>
    </div>
    
    <!-- Choice Details Modal -->
    <div id="choice-details-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-title">Детализация выбора</div>
            <div class="modal-body">
                <div id="choice-details-loading" class="loading">
                    <div class="loading-spinner"></div>
                </div>
                <div id="choice-details-content">
                    <div class="form-group">
                        <label class="form-label">Частота:</label>
                        <div id="detail-frequency"></div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ID выбора:</label>
                        <div id="detail-choice-id"></div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Варианты ответов:</label>
                        <div id="detail-options"></div>
                    </div>
                    <div class="chart-container">
                        <canvas id="detail-chart"></canvas>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Список пользователей:</label>
                        <table class="user-table">
                            <thead>
                                <tr>
                                    <th>Пользователь</th>
                                    <th>Вариант</th>
                                    <th>Дата выбора</th>
                                </tr>
                            </thead>
                            <tbody id="detail-users-table"></tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="close-details" class="btn">Закрыть</button>
            </div>
        </div>
    </div>
    
    <script type="module" src="scripts/admin/admin-main.js"></script>
</body>
</html>
